ðŸš€ Smart Full Stack Deployment
==============================
==> Starting smart deployment
==> Checking dependencies
âœ… kind
âœ… kubectl
âœ… ngrok
âœ… docker
==> Setting up Kubernetes cluster
No kind clusters found.
ðŸš€ Deploying Vue.js App to Kubernetes
=====================================

ðŸ“¦ Step 1: Creating Kubernetes cluster...
Creating cluster "my-apps-cluster" ...
 âœ“ Ensuring node image (kindest/node:v1.34.0) ðŸ–¼
 âœ“ Preparing nodes ðŸ“¦  
 âœ“ Writing configuration ðŸ“œ 
 âœ“ Starting control-plane ðŸ•¹ï¸ 
 âœ“ Installing CNI ðŸ”Œ 
 âœ“ Installing StorageClass ðŸ’¾ 
Set kubectl context to "kind-my-apps-cluster"
You can now use your cluster with:

kubectl cluster-info --context kind-my-apps-cluster

ðŸŒ Step 2: Installing NGINX Ingress Controller...
namespace/ingress-nginx created
serviceaccount/ingress-nginx created
serviceaccount/ingress-nginx-admission created
role.rbac.authorization.k8s.io/ingress-nginx created
role.rbac.authorization.k8s.io/ingress-nginx-admission created
clusterrole.rbac.authorization.k8s.io/ingress-nginx created
clusterrole.rbac.authorization.k8s.io/ingress-nginx-admission created
rolebinding.rbac.authorization.k8s.io/ingress-nginx created
rolebinding.rbac.authorization.k8s.io/ingress-nginx-admission created
clusterrolebinding.rbac.authorization.k8s.io/ingress-nginx created
clusterrolebinding.rbac.authorization.k8s.io/ingress-nginx-admission created
configmap/ingress-nginx-controller created
service/ingress-nginx-controller created
service/ingress-nginx-controller-admission created
deployment.apps/ingress-nginx-controller created
job.batch/ingress-nginx-admission-create created
job.batch/ingress-nginx-admission-patch created
ingressclass.networking.k8s.io/nginx created
validatingwebhookconfiguration.admissionregistration.k8s.io/ingress-nginx-admission created
â³ Waiting for ingress controller...
pod/ingress-nginx-controller-76f7f87994-n9n98 condition met
â³ Waiting for ingress to be fully ready...
validatingwebhookconfiguration.admissionregistration.k8s.io "ingress-nginx-admission" deleted

ðŸš€ Step 3: Deploying Vue.js application...
deployment.apps/node-app created
service/node-app-service created
ingress.networking.k8s.io/main-ingress created
â³ Vue.js app is building with Browserify + Vueify...
This process takes 30-60 seconds...
ðŸ“Š Waiting for pod to start...
pod/node-app-549867cf97-mldlm condition met
ðŸ” Build logs:
  http://127.0.0.1:8080
  http://10.244.0.8:8080
Hit CTRL-C to stop the server
[2025-11-17T13:03:08.188Z] "GET /" "kube-probe/1.34"
(node:63) [DEP0066] DeprecationWarning: OutgoingMessage.prototype._headers is deprecated
(Use `node --trace-deprecation ...` to show where the warning was created)
13:03:30 GMT+0000 (Coordinated Universal Time) [HMR] Emitting updates
13:03:30 GMT+0000 (Coordinated Universal Time) [HMR] Listening on localhost:3123
2343941 bytes written to dist/build.js (24.21 seconds) at 1:03:32 PM
[2025-11-17T13:03:53.274Z] "GET /" "kube-probe/1.34"
ðŸ’¡ Still building... Check progress with:
kubectl logs -l app=node-app --follow
âœ… Deployment complete!

ðŸŒ Access your Vue.js app:
Local:    http://localhost:8080
Should show: Vue.js logo with 'Welcome to Your Vue.js App'

ðŸ“ Verification commands:
Check status:    kubectl get pods -l app=node-app
View logs:       kubectl logs -l app=node-app
Test app:        curl http://localhost:8080

ðŸš€ Expose with Ngrok:
cd ../ngrok-tunnel-manager && ./ngrok-manager.sh start kubernetes-ingress
âœ… Cluster created successfully
âœ… Vue.js app is already running
==> Starting ngrok tunnel
==> Starting ngrok on port 8080
âœ… Ngrok started with PID: 703487
==> Waiting for tunnel to establish...
âš ï¸ Waiting for ngrok... (1/15)
âœ… Ngrok tunnel ready
ðŸŒ Public URL: https://makhi-lactational-vallie.ngrok-free.dev
âœ… Full stack deployment completed!
==================================
ðŸ›‘ Stopping Full Stack Deployment
==================================
==> Stopping ngrok tunnel
==> Ngrok is running - stopping...
==> Stopping ngrok via PID file (PID: 703487)
âœ… Stopped ngrok via PID file
âœ… Ngrok verified as stopped

==> Stopping Kubernetes application
==> Deleting Kubernetes resources...
ingress.networking.k8s.io "main-ingress" deleted from default namespace
âœ… Deleted ingress
service "node-app-service" deleted from default namespace
âœ… Deleted service
deployment.apps "node-app" deleted from default namespace
âœ… Deleted deployment
==> Cleaning up 1 remaining pods
pod "node-app-549867cf97-mldlm" force deleted from default namespace
âœ… Remaining pods cleaned up

==> Stopping Kubernetes cluster
==> Deleting cluster: my-apps-cluster
âœ… Kubernetes cluster stopped

==> Cleaning up temporary files
âœ… Removed /tmp/ngrok.log
